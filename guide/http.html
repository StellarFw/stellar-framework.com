
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>HTTP - Stellar</title>
    <meta charset="utf-8">
    <meta name="description" content="Stellar is an action based web framework for creating Web APIs easily!">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <meta property="og:type" content="article">
    <meta property="og:title" content="HTTP - Stellar">
    <meta property="og:description" content="Stellar is an action based web framework for creating Web APIs easily!">
    <meta property="og:image" content="https://stellar-framework.com/images/logo.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="HTTP - Stellar">
    <meta name="twitter:description" content="Stellar is an action based web framework for creating Web APIs easily!">
    <meta name="twitter:image" content="https://stellar-framework.com/images/logo.png">

    <link rel="icon" href="/images/logo.png" type="image/x-icon">

    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Roboto Mono' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Dosis:500' rel='stylesheet' type='text/css'>

    <!-- main page styles -->
    <link rel="stylesheet" href="/css/page.css">

    <!-- this needs to be loaded before guide's inline scripts -->
    <script>window.PAGE_TYPE = 'guide'</script>
  </head>
  <body class="docs">    <div id="mobile-bar" >
      <a class="menu-button"></a>
      <a class="logo" href="/"></a>
    </div>

    <div id="header">
    <a id="logo" href="/">
        <img src="/images/logo.png">
        <span>Stellar</span>
    </a>
    <ul id="nav">
        <li>
  <form id="search-form">
    <input type="text" id="search-query-nav" class="search-query st-default-search-input">
  </form>
</li>
<li><a href="/guide/" class="nav-link current">Guide</a></li>
<li class="nav-dropdown-container">
  <a class="nav-link">Community</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/stellarFw/stellar" class="nav-link" target="_blank">GitHub</a></li>
    <li><a href="https://gitter.im/StellarFw/StellarFw" class="nav-link" target="_blank">Chat</a></li>
    <li><a href="https://twitter.com/gil0mendes" class="nav-link" target="_blank">Twitter</a></li>
  </ul>
</li>

<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/StellarFw/Identify" class="nav-link" target="_blank">Identify</a></li>
  </ul>
</li>


    </ul>
</div>

    
      <div id="main" class="fix-sidebar">
        
          
  <div class="sidebar">
  <ul class="main-menu">
    <li>
  <form id="search-form">
    <input type="text" id="search-query-sidebar" class="search-query st-default-search-input">
  </form>
</li>
<li><a href="/guide/" class="nav-link current">Guide</a></li>
<li class="nav-dropdown-container">
  <a class="nav-link">Community</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/stellarFw/stellar" class="nav-link" target="_blank">GitHub</a></li>
    <li><a href="https://gitter.im/StellarFw/StellarFw" class="nav-link" target="_blank">Chat</a></li>
    <li><a href="https://twitter.com/gil0mendes" class="nav-link" target="_blank">Twitter</a></li>
  </ul>
</li>

<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/StellarFw/Identify" class="nav-link" target="_blank">Identify</a></li>
  </ul>
</li>


  </ul>
  <div class="list">
    <div class="main-sponsor"></div>
    <a class="become-backer" href="/support-stellar">
      Become a Backer
    </a>

    <ul class="menu-root">
      
        <li>
          <a href="/guide/index.html" class="sidebar-link">Overview</a>
        </li>
      
        <li>
          <a href="/guide/installation.html" class="sidebar-link">Installation</a>
        </li>
      
        <li>
          <a href="/guide/actions.html" class="sidebar-link">Actions</a>
        </li>
      
        <li>
          <a href="/guide/models.html" class="sidebar-link">Models</a>
        </li>
      
        <li>
          <a href="/guide/tasks.html" class="sidebar-link">Tasks</a>
        </li>
      
        <li>
          <a href="/guide/middleware.html" class="sidebar-link">Middleware</a>
        </li>
      
        <li>
          <a href="/guide/satellites.html" class="sidebar-link">Satellites</a>
        </li>
      
        <li>
          <a href="/guide/cluster.html" class="sidebar-link">Cluster</a>
        </li>
      
        <li>
          <a href="/guide/cache.html" class="sidebar-link">Cache</a>
        </li>
      
        <li>
          <a href="/guide/chat.html" class="sidebar-link">Chat</a>
        </li>
      
        <li>
          <a href="/guide/development_mode.html" class="sidebar-link">Development Mode</a>
        </li>
      
        <li>
          <a href="/guide/file_system.html" class="sidebar-link">File System</a>
        </li>
      
        <li>
          <a href="/guide/events.html" class="sidebar-link">Events</a>
        </li>
      
        <li>
          <a href="/guide/websocket.html" class="sidebar-link">WebSocket</a>
        </li>
      
        <li>
          <a href="/guide/tcp.html" class="sidebar-link">TCP</a>
        </li>
      
        <li>
          <a href="/guide/http.html" class="sidebar-link current">HTTP</a>
        </li>
      
        <li>
          <a href="/guide/security.html" class="sidebar-link">Security</a>
        </li>
      
        <li>
          <a href="/guide/validation.html" class="sidebar-link">Validation</a>
        </li>
      
        <li>
          <a href="/guide/logging.html" class="sidebar-link">Logging</a>
        </li>
      
        <li>
          <a href="/guide/commands.html" class="sidebar-link">Commands</a>
        </li>
      
    </ul>
  </div>
</div>



<div class="content guide with-sidebar http-guide">
  
    <h1>HTTP</h1>
  

  <h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>The HTTP server allows you to perform actions and display files using HTTP and HTTPS protocols. The API can be accessed through a browser, cURL command, etc. You can access actions using URLs of the form <code>&lt;url&gt;?action=&lt;action_name&gt;</code> or <code>&lt;url&gt;/api/&lt;action_name&gt;</code>. For example, if you want to access the <code>getPost</code> action on a local server that is listening on port 8080, you would have to make a call to the URL <code>http://127.0.0.1:8080/api?action=getPosts</code>.</p>
<p>The JSON below shows an example of a response from the server.</p>
<figure class="highlight json"><table><tr><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"questions"</span>: [ ],</div><div class="line">  <span class="attr">"serverInformation"</span>: &#123;</div><div class="line">    <span class="attr">"serverName"</span>: <span class="string">"Stellar API"</span>,</div><div class="line">    <span class="attr">"apiVersion"</span>: <span class="string">"0.0.1"</span>,</div><div class="line">    <span class="attr">"requestDuration"</span>: <span class="number">194</span>,</div><div class="line">    <span class="attr">"currentTime"</span>: <span class="number">1471702323600</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"requesterInformation"</span>: &#123;</div><div class="line">    <span class="attr">"id"</span>: <span class="string">"6f9e36f49e49dd7ac30348a0d9826e367ac747d7-cec5fb6e-2b0b-416e-8529-f897ea666d39"</span>,</div><div class="line">    <span class="attr">"fingerprint"</span>: <span class="string">"6f9e36f49e49dd7ac30348a0d9826e367ac747d7"</span>,</div><div class="line">    <span class="attr">"remoteIP"</span>: <span class="string">"127.0.0.1"</span>,</div><div class="line">    <span class="attr">"receivedParams"</span>: &#123;</div><div class="line">      <span class="attr">"action"</span>: <span class="string">"getQuestions"</span>,</div><div class="line">      <span class="attr">"apiVersion"</span>: <span class="number">1</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Send-Files"><a href="#Send-Files" class="headerlink" title="Send Files"></a>Send Files</h2><p>Stellar also can serve files to the client. Stellar does not cache files; in each request files are read from disk. The following code is an example of how to send a file to the client from within an action:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="comment">// specifies the file to send to the client</span></div><div class="line">action.connection.sendFile(<span class="string">'/path/to/file.txt'</span>)</div><div class="line"></div><div class="line"><span class="comment">// informs that isn't to render the response</span></div><div class="line">action.toRender = <span class="literal">false</span></div><div class="line"></div><div class="line"><span class="comment">// finish the action execution</span></div><div class="line">next()</div></pre></td></tr></table></figure>
<ul>
<li><p>The root of web server <code>/</code> can be used to serve files (<code>/files</code>) or actions (<code>/api</code>). Their behavior can be changed using the configuration setting <code>api.config.servers.web.rootEndpointType</code> (the default is to serve files).</p>
</li>
<li><p>When a file is not found the result is a page with an HTTP 404 error.</p>
</li>
<li><p>Whenever possible the <a href="https://www.npmjs.com/package/mime" target="_blank" rel="external">mime</a> package will be used to add a <code>Content-Type</code> header in the response.</p>
</li>
</ul>
<blockquote>
<p>Note: see the <a href="./file_system.html">File System</a> section for more information about sending files.</p>
</blockquote>
<h2 id="Routes"><a href="#Routes" class="headerlink" title="Routes"></a>Routes</h2><p>For web clients (HTTP and HTTPS), you can define an optional RESTful mapping to help route requests to actions. If the client doesn’t specify an action via a parameter, and the base route isn’t a named action, Stellar will attempt to determine the action using the <code>routes.json</code> file located in the module’s root folder.</p>
<p>There are three ways clients can access actions via a web server:</p>
<ul>
<li><p>No route, using GET parameters: <code>example.com/api?action=getPosts</code></p>
</li>
<li><p>Through basic routing, where the name of the action is found in the path after <code>/api</code>, for example: <code>example.com/api/getPosts</code></p>
</li>
<li><p>If the <code>api.config.servers.web.rootEndpointType</code> setting has the value <code>&#39;file&#39;</code> it means that actions must be accessed using the prefix <code>/api</code>. For the server to respond to an <code>example.com/posts</code> route, <code>api.config.servers.web.rootEndpointType</code> must be set to <code>&#39;api&#39;</code>.</p>
</li>
</ul>
<blockquote>
<p>Note: when <code>api.config.servers.web.rootEndpointType</code> is set to <code>&#39;api&#39;</code>, routes starting with <code>/api</code> still work.</p>
</blockquote>
<p>The JSON below shows an example of a route declaration:</p>
<figure class="highlight json"><table><tr><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"all"</span>: [</div><div class="line">    &#123; <span class="attr">"path"</span>: <span class="string">"/cache/:key/:value"</span>, <span class="attr">"action"</span>: <span class="string">"setCache"</span> &#125;</div><div class="line">  ],</div><div class="line">  <span class="attr">"get"</span>: [</div><div class="line">    &#123; <span class="attr">"path"</span>: <span class="string">"/question"</span>,      <span class="attr">"action"</span>: <span class="string">"getQuestions"</span> &#125;,</div><div class="line">    &#123; <span class="attr">"path"</span>: <span class="string">"/question/:id"</span>,  <span class="attr">"action"</span>: <span class="string">"getQuestion"</span> &#125;</div><div class="line">  ],</div><div class="line">  <span class="attr">"post"</span>: [</div><div class="line">    &#123; <span class="attr">"path"</span>: <span class="string">"/question"</span>, <span class="attr">"action"</span>: <span class="string">"createQuestion"</span> &#125;</div><div class="line">  ],</div><div class="line">  <span class="attr">"put"</span>: [</div><div class="line">    &#123; <span class="attr">"path"</span>: <span class="string">"/question/:id"</span>, <span class="attr">"action"</span>: <span class="string">"editQuestion"</span> &#125;</div><div class="line">  ],</div><div class="line">  <span class="attr">"delete"</span>: [</div><div class="line">    &#123; <span class="attr">"path"</span>: <span class="string">"/question/:id"</span>, <span class="attr">"action"</span>: <span class="string">"removeQuestion"</span> &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Use-Versions"><a href="#Use-Versions" class="headerlink" title="Use Versions"></a>Use Versions</h3><p>Routes will match the newest version of <code>apiVersion</code>. If you want to have a specific route match a specific version of an action, you can provide the <code>apiVersion</code> parameter in your route definitions. The following example shows this feature:</p>
<figure class="highlight json"><table><tr><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"all"</span>: [</div><div class="line">    &#123; <span class="attr">"path"</span>: <span class="string">"/actionName/old"</span>, <span class="attr">"action"</span>: <span class="string">"actionName"</span>, <span class="attr">"apiVersion"</span>: <span class="number">1</span> &#125;,</div><div class="line">    &#123; <span class="attr">"path"</span>: <span class="string">"/actionName/new"</span>, <span class="attr">"action"</span>: <span class="string">"actionName"</span>, <span class="attr">"apiVersion"</span>: <span class="number">2</span> &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This would create both <code>/api/actionName/old</code> and <code>/api/actionName/new</code>, mapping to <code>apiVersion</code> 1 and 2 respectively.</p>
<p>In your action and middleware, if a route was matched, you can see the details of the match by inspecting <code>action.connection.matchedRoute</code> which includes <code>path</code> and <code>action</code>.</p>
<h3 id="Disabling-Access-to-api"><a href="#Disabling-Access-to-api" class="headerlink" title="Disabling Access to /api"></a>Disabling Access to <code>/api</code></h3><p>To disabling access to actions using <code>/api</code> and only allow access the actions via the server root, you must change the value of <code>api.config.servers.web.urlPathForActions</code> to <code>null</code>.</p>
<blockquote>
<p>Note: if you do this, the <code>api.config.servers.web.rootEndpointType</code> setting must be set to <code>&#39;api&#39;</code>, otherwise there will be no way to make calls to actions.</p>
</blockquote>
<h2 id="Parameters"><a href="#Parameters" class="headerlink" title="Parameters"></a>Parameters</h2><p>The parameters can be specified using GET or POST. Parameters are loaded in this order: GET -&gt; POST (normal) -&gt; POST (multipart). This means that if you access URL <code>example.com/?key=getValue</code> and you post a variable <code>key=postValue</code> as well, <code>postValue</code> will be the value used.</p>
<p>File uploads from forms will also appear in <code>connection.params</code>, but will be represented as an object with more information. That is, if you uploaded a file called “image”, you would have <code>connection.params.image.path</code>, <code>connection.params.image.name</code> (original file name), and <code>connection.params.image.type</code> available to you.</p>
<blockquote>
<p>Note: you can post BODY JSON payloads to Stellar in the form of an object or array.</p>
</blockquote>
<h2 id="Uploading-Files"><a href="#Uploading-Files" class="headerlink" title="Uploading Files"></a>Uploading Files</h2><p>Stellar uses the <a href="https://www.npmjs.com/package/formidable" target="_blank" rel="external">formidable</a> form parsing library. You can upload multiple files to an action and they will be available within <code>connection.params</code> as a <strong>formidable</strong> response object containing references to the original file name, where the uploaded file was stored temporarily, etc.</p>
<h2 id="Client-Library"><a href="#Client-Library" class="headerlink" title="Client Library"></a>Client Library</h2><p>Although the Stellar client-side JavaScript library is mostly for WebSockets, it can also be used to make HTTP actions when not connected to a WebSocket (and WebSocket clients will fall back to HTTP requests when disconnected).</p>
<figure class="highlight html"><table><tr><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!-- (...) --&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- import Stellar client library  --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"//server.example.com/stellar-client"</span>&gt;</span><span class="xml"></span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="meta">'use strict'</span></div><div class="line"></div><div class="line"><span class="comment">// create a new client</span></div><div class="line"><span class="keyword">let</span> stellar = <span class="keyword">new</span> StellarClient(&#123; url: <span class="string">'server.example.com:8080'</span> &#125;)</div><div class="line"></div><div class="line"><span class="comment">// call an action</span></div><div class="line">stellar.action(<span class="string">'createPost'</span>, &#123; title: <span class="string">'Example!'</span>, content: <span class="string">'Some content...'</span> &#125;, (error, response) =&gt; &#123;</div><div class="line">  <span class="comment">// do something...</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<blockquote>
<p>Note: since we never called <code>stellar.connect</code> the request is made via HTTP. More information can be found in the <a href="./websocket.html">WebSocket section</a>.</p>
</blockquote>


  
      <div class="guide-links">
        
          <span>← <a href="/guide/tcp.html">TCP</a></span>
        
        
          <span style="float:right"><a href="/guide/security.html">Security</a> →</span>
        
      </div>
    

    <div class="footer">
      Caught a mistake or want to contribute to documentation?
      <a href="https://github.com/StellarFw/stellar-framework.com/tree/master/src/guide/http.md" target="_blank">
        Edit this page on Github!
      </a>
    </div>
</div>

        
      </div>
      <script src="/js/smooth-scroll.min.js"></script>
    

    <!-- search -->
    <link href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="/css/search.css">
    <script src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js" type="text/javascript"></script>

    <!-- main custom script for sidebar and other cool things -->
    <script src="/js/common.js"></script>

    <!-- ga -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-77611901-1', 'stellar-framework.com');
      ga('send', 'pageview');
    </script>

    <!-- fastclick  -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        FastClick.attach(document.body)
      }, false)
    </script>
  </body>
</html>
