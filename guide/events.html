
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Events - Stellar</title>

    <!-- charset -->
    <meta charset="utf-8">

    <!-- description -->
    <meta name="description" content="Stellar is an action based web framework for creating Web APIs easily!">

    <!-- viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <!-- fonts -->
    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:400,600|Roboto Mono' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Dosis:300,500' rel='stylesheet' type='text/css'>

    <!-- page type -->
    <script>
      window.PAGE_TYPE = 'guide'
    </script>

    <!-- load page style -->
    <link rel="stylesheet" href="/css/page.css">

    <!-- load Google Analytics -->
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-77611901-1', 'auto');
  ga('send', 'pageview');
</script>

  </head>
  <body>
    <div id="mobile-bar">
      <a class="menu-button"></a>
      <a class="logo" href="/"></a>
    </div>

    
      <div id="header">
    <a id="logo" href="/">
        <img src="/images/logo.png">
        <span>Stellar</span>
    </a>
    <ul id="nav">
        <li><a href="/guide/" class="nav-link current">Guide</a></li>
<li><a href="/blog/" class="nav-link">Blog</a></li>
<li class="nav-dropdown-container">
  <a class="nav-link">Community</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/stellarFw/stellar" class="nav-link" target="_blank">GitHub</a></li>
    <li><a href="https://twitter.com/gil0mendes" class="nav-link" target="_blank">Twitter</a></li>
  </ul>
</li>
    </ul>
</div>

      <div id="main">
        
          
  <div class="sidebar">
  <ul class="main-menu">
    <li><a href="/guide/" class="nav-link current">Guide</a></li>
<li><a href="/blog/" class="nav-link">Blog</a></li>
<li class="nav-dropdown-container">
  <a class="nav-link">Community</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/stellarFw/stellar" class="nav-link" target="_blank">GitHub</a></li>
    <li><a href="https://twitter.com/gil0mendes" class="nav-link" target="_blank">Twitter</a></li>
  </ul>
</li>
  </ul>
  <div class="list">
    <div class="list">
      <div id="donate" style="margin-bottom: 20px">
        <span class="wrapper" style="width: 110px">
          <img src="/images/patreon.png">
          <a href="/support-stellar">Support Stellar</a>
        </span>
      </div>
    </div>
    <ul class="menu-root">
      
        <li>
          <a href="/guide/index.html" class="sidebar-link">Overview</a>
        </li>
      
        <li>
          <a href="/guide/installation.html" class="sidebar-link">Installation</a>
        </li>
      
        <li>
          <a href="/guide/actions.html" class="sidebar-link">Actions</a>
        </li>
      
        <li>
          <a href="/guide/tasks.html" class="sidebar-link">Tasks</a>
        </li>
      
        <li>
          <a href="/guide/middleware.html" class="sidebar-link">Middleware</a>
        </li>
      
        <li>
          <a href="/guide/satellites.html" class="sidebar-link">Satellites</a>
        </li>
      
        <li>
          <a href="/guide/cluster.html" class="sidebar-link">Cluster</a>
        </li>
      
        <li>
          <a href="/guide/cache.html" class="sidebar-link">Cache</a>
        </li>
      
        <li>
          <a href="/guide/chat.html" class="sidebar-link">Chat</a>
        </li>
      
        <li>
          <a href="/guide/development_mode.html" class="sidebar-link">Development Mode</a>
        </li>
      
        <li>
          <a href="/guide/file_system.html" class="sidebar-link">File System</a>
        </li>
      
        <li>
          <a href="/guide/logging.html" class="sidebar-link">Logging</a>
        </li>
      
        <li>
          <a href="/guide/events.html" class="sidebar-link current">Events</a>
        </li>
      
        <li>
          <a href="/guide/websocket.html" class="sidebar-link">WebSocket</a>
        </li>
      
        <li>
          <a href="/guide/tcp.html" class="sidebar-link">TCP</a>
        </li>
      
        <li>
          <a href="/guide/http.html" class="sidebar-link">HTTP</a>
        </li>
      
        <li>
          <a href="/guide/security.html" class="sidebar-link">Security</a>
        </li>
      
    </ul>
  </div>
</div>



<div class="content guide with-sidebar">
  <h1>Events</h1>
  <h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>Stellar has an event system that allows you to subscribe to and listen for events in the application. This is useful to manipulate data during the execution or extend features by adding new behaviors to the existing logic. Listeners must be stored in a module’s <code>listeners</code> folder.</p>
<h2 id="Generate-Listeners"><a href="#Generate-Listeners" class="headerlink" title="Generate Listeners"></a>Generate Listeners</h2><p>Instead of manually creating a file for each listener, developers can use the <code>stellar</code> command line tool to do this automatically:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ stellar makeListener &lt;eventName&gt; --module=&lt;moduleName&gt;</span><br></pre></td></tr></table></figure>
<h2 id="Define-a-Listener"><a href="#Define-a-Listener" class="headerlink" title="Define a Listener"></a>Define a Listener</h2><p>The code below shows the implementation of a listener.  In this example the listener will respond to the <code>social.newComment</code> event and will add a new task to the system to send an email every time a comment is made.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// File: modules/social/listeners/comments.js</span></span><br><span class="line"><span class="meta"></span><br><span class="line">'use strict'</span></span><br><span class="line"></span><br><span class="line">exports.default = [&#123;</span><br><span class="line">  event: <span class="string">'social.newComment'</span>,</span><br><span class="line">  run: (api, params, next) &#123;</span><br><span class="line">    <span class="comment">// enqueue a task to send a notification email for the new comment</span></span><br><span class="line">    api.tasks.enqueue(<span class="string">'sendNewCommentEmail'</span>, params)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// create a new property called `emailSent` and set it to `true`</span></span><br><span class="line">    params.emailSent = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// next(error &lt;Error&gt;)</span></span><br><span class="line">    next()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure>
<h2 id="Trigger-Events"><a href="#Trigger-Events" class="headerlink" title="Trigger Events"></a>Trigger Events</h2><p>The code below shows how an event can be triggered. In this case the developer wants to fire the <code>social.newComment</code> event and give listeners a variable with the new comment data:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">api.events.fire(<span class="string">'social.newComment'</span>, newComment, response =&gt; &#123;</span><br><span class="line">  <span class="comment">// do something with the modified data...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="Register-a-Listener-Manually"><a href="#Register-a-Listener-Manually" class="headerlink" title="Register a Listener Manually"></a>Register a Listener Manually</h2><p>To register a listener manually the developer can use the following API:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">api.events.listener(<span class="string">'blog.newUser'</span>, (api, params, next) =&gt; &#123;</span><br><span class="line">  <span class="comment">// do something...</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// finish the listener execution</span></span><br><span class="line">  next()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

  
      <div class="guide-links">
        
          <span>← <a href="/guide/logging.html">Logging</a></span>
        
        
          <span style="float:right"><a href="/guide/websocket.html">WebSocket</a> →</span>
        
      </div>
    

    <div class="footer">
      Caught a mistake or want to contribute to documentation?
      <a href="https://github.com/gil0mendes/pt.stellar-framework.com/tree/master/src/guide/events.md" target="_blank">
        Edit this page on Github!
      </a>
    </div>
</div>

        
      </div>

      <script src="/js/smooth-scroll.min.js"></script>
      <script src="/js/common.js"></script>
    

    <!-- enable FastClick  -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        FastClick.attach(document.body)
      }, false)
    </script>
  </body>
</html>
