
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Events - Stellar</title>
    <meta charset="utf-8">
    <meta name="description" content="Stellar is an action based web framework for creating Web APIs easily!">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Events - Stellar">
    <meta property="og:description" content="Stellar is an action based web framework for creating Web APIs easily!">
    <meta property="og:image" content="https://stellar-framework.com/images/logo.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Events - Stellar">
    <meta name="twitter:description" content="Stellar is an action based web framework for creating Web APIs easily!">
    <meta name="twitter:image" content="https://stellar-framework.com/images/logo.png">

    <link rel="icon" href="/images/logo.png" type="image/x-icon">

    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Roboto Mono' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Dosis:500' rel='stylesheet' type='text/css'>

    <!-- main page styles -->
    <link rel="stylesheet" href="/css/page.css">

    <!-- this needs to be loaded before guide's inline scripts -->
    <script>window.PAGE_TYPE = 'guide'</script>
  </head>
  <body class="docs">    <div id="mobile-bar" >
      <a class="menu-button"></a>
      <a class="logo" href="/"></a>
    </div>

    <div id="header">
    <a id="logo" href="/">
        <img src="/images/logo.png">
        <span>Stellar</span>
    </a>
    <ul id="nav">
        <li>
  <form id="search-form">
    <input type="text" id="search-query-nav" class="search-query st-default-search-input">
  </form>
</li>
<li><a href="/guide/" class="nav-link current">Guide</a></li>
<li class="nav-dropdown-container">
  <a class="nav-link">Community</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/stellarFw/stellar" class="nav-link" target="_blank">GitHub</a></li>
    <li><a href="https://gitter.im/StellarFw/StellarFw" class="nav-link" target="_blank">Chat</a></li>
    <li><a href="https://twitter.com/gil0mendes" class="nav-link" target="_blank">Twitter</a></li>
  </ul>
</li>

<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/StellarFw/Identify" class="nav-link" target="_blank">Identify</a></li>
  </ul>
</li>


    </ul>
</div>

    
      <div id="main" class="fix-sidebar">
        
          
  <div class="sidebar">
  <ul class="main-menu">
    <li>
  <form id="search-form">
    <input type="text" id="search-query-sidebar" class="search-query st-default-search-input">
  </form>
</li>
<li><a href="/guide/" class="nav-link current">Guide</a></li>
<li class="nav-dropdown-container">
  <a class="nav-link">Community</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/stellarFw/stellar" class="nav-link" target="_blank">GitHub</a></li>
    <li><a href="https://gitter.im/StellarFw/StellarFw" class="nav-link" target="_blank">Chat</a></li>
    <li><a href="https://twitter.com/gil0mendes" class="nav-link" target="_blank">Twitter</a></li>
  </ul>
</li>

<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/StellarFw/Identify" class="nav-link" target="_blank">Identify</a></li>
  </ul>
</li>


  </ul>
  <div class="list">
    <div class="main-sponsor"></div>
    <a class="become-backer" href="/support-stellar">
      Become a Backer
    </a>

    <ul class="menu-root">
      
        
        
          
        

        <li>
          <a href="/guide/index.html" class="sidebar-link">Overview</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/installation.html" class="sidebar-link">Installation</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/actions.html" class="sidebar-link">Actions</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/tasks.html" class="sidebar-link">Tasks</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/middleware.html" class="sidebar-link">Middleware</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/satellites.html" class="sidebar-link">Satellites</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/cluster.html" class="sidebar-link">Cluster</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/cache.html" class="sidebar-link">Cache</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/chat.html" class="sidebar-link">Chat</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/development_mode.html" class="sidebar-link">Development Mode</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/file_system.html" class="sidebar-link">File System</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/events.html" class="sidebar-link current">Events</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/websocket.html" class="sidebar-link">WebSocket</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/tcp.html" class="sidebar-link">TCP</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/http.html" class="sidebar-link">HTTP</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/security.html" class="sidebar-link">Security</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/validation.html" class="sidebar-link">Validation</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/logging.html" class="sidebar-link">Logging</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/commands.html" class="sidebar-link">Commands</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/testing.html" class="sidebar-link">Testing</a>
        </li>
      
        
        
          
            <li><h3>Models</h3></li>
          
        

        <li>
          <a href="/guide/models.html" class="sidebar-link">Introduction</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/models-data_types.html" class="sidebar-link">Data Types and Attributes</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/models-validations.html" class="sidebar-link">Validations</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/models-instance.html" class="sidebar-link">Instance and Class Methods</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/models-associations.html" class="sidebar-link">Associations</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/models-configurations.html" class="sidebar-link">Model Configuration</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/models-queries.html" class="sidebar-link">Queries</a>
        </li>
      
    </ul>
  </div>
</div>



<div class="content guide with-sidebar events-guide">
  
    <h1>Events</h1>
  

  <h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>Stellar has an event system that allows you to subscribe to and listen for events in the application. This is useful to manipulate data during the execution or extend features by adding new behaviors to the existing logic. Listeners must be stored in a module’s <code>listeners</code> folder.</p>
<p>Stellar can live reload listeners without the need to restart the server, with this your development will be even easier.</p>
<h2 id="Generate-Listeners"><a href="#Generate-Listeners" class="headerlink" title="Generate Listeners"></a>Generate Listeners</h2><p>Instead of manually creating a file for each listener, developers can use the <code>stellar</code> command line tool to do this automatically:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">$ stellar make listener &lt;event_name&gt;</div></pre></td></tr></table></figure>
<h2 id="Define-a-Listener"><a href="#Define-a-Listener" class="headerlink" title="Define a Listener"></a>Define a Listener</h2><p>The code below shows the implementation of a listener.  In this example the listener will respond to the <code>social.newComment</code> event and will add a new task to the system to send an email every time a comment is made.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><div class="line"><span class="comment">// File: modules/social/listeners/comments.js</span></div><div class="line"><span class="meta"></span></div><div class="line">'use strict'</div><div class="line"></div><div class="line">exports.default = [&#123;</div><div class="line">  <span class="attr">event</span>: <span class="string">'social.newComment'</span>,</div><div class="line">  run (api, params, next) &#123;</div><div class="line">    <span class="comment">// enqueue a task to send a notification email for the new comment</span></div><div class="line">    api.tasks.enqueue(<span class="string">'sendNewCommentEmail'</span>, params)</div><div class="line"></div><div class="line">    <span class="comment">// create a new property called `emailSent` and set it to `true`</span></div><div class="line">    params.emailSent = <span class="literal">true</span></div><div class="line"></div><div class="line">    <span class="comment">// next(error &lt;Error&gt;)</span></div><div class="line">    next()</div><div class="line">  &#125;</div><div class="line">&#125;]</div></pre></td></tr></table></figure>
<p>As you can see on the example above, you need define at least two properties (<code>event</code>, and <code>run</code>). The <code>event</code> is where you define the event that you want listening for, this property can be a simple <code>string</code> or an <code>array</code>, when you want apply the same listener for multiple events. The <code>run</code> property is where you put the listener’s logic.</p>
<h2 id="Trigger-Events"><a href="#Trigger-Events" class="headerlink" title="Trigger Events"></a>Trigger Events</h2><p>The code below shows how an event can be triggered, the event system uses promises to get away from the callback-hell. In this case the developer wants to fire the <code>social.newComment</code> event and give listeners a variable with the new comment data:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><div class="line">api.events.fire(<span class="string">'social.newComment'</span>, newComment)</div><div class="line">  .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</div><div class="line">    <span class="comment">// do something with the modified data...</span></div><div class="line">  &#125;)</div></pre></td></tr></table></figure>
<h2 id="Register-a-Listener-Manually"><a href="#Register-a-Listener-Manually" class="headerlink" title="Register a Listener Manually"></a>Register a Listener Manually</h2><p>To register a listener manually the developer can use the following API:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><div class="line">api.events.listener(<span class="string">'blog.newUser'</span>, (api, params, next) =&gt; &#123;</div><div class="line">  <span class="comment">// pass a property to the response</span></div><div class="line">  params.someKey = <span class="string">'someValue'</span></div><div class="line"></div><div class="line">  <span class="comment">// finish the listener execution</span></div><div class="line">  next()</div><div class="line">&#125;)</div></pre></td></tr></table></figure>


  
      <div class="guide-links">
        
          <span>← <a href="/guide/file_system.html">File System</a></span>
        
        
          <span style="float:right"><a href="/guide/websocket.html">WebSocket</a> →</span>
        
      </div>
    

    <div class="footer">
      Caught a mistake or want to contribute to documentation?
      <a href="https://github.com/StellarFw/stellar-framework.com/tree/master/src/guide/events.md" target="_blank">
        Edit this page on Github!
      </a>
    </div>
</div>

        
      </div>
      <script src="/js/smooth-scroll.min.js"></script>
    

    <!-- search -->
    <link href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="/css/search.css">
    <script src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js" type="text/javascript"></script>

    <!-- main custom script for sidebar and other cool things -->
    <script src="/js/common.js"></script>

    <!-- ga -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-77611901-1', 'stellar-framework.com');
      ga('send', 'pageview');
    </script>

    <!-- fastclick  -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        FastClick.attach(document.body)
      }, false)
    </script>
  </body>
</html>
