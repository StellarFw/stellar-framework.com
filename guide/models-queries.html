
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Queries - Stellar</title>
    <meta charset="utf-8">
    <meta name="description" content="Stellar is an action based web framework for creating Web APIs easily!">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Queries - Stellar">
    <meta property="og:description" content="Stellar is an action based web framework for creating Web APIs easily!">
    <meta property="og:image" content="https://stellar-framework.com/images/logo.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Queries - Stellar">
    <meta name="twitter:description" content="Stellar is an action based web framework for creating Web APIs easily!">
    <meta name="twitter:image" content="https://stellar-framework.com/images/logo.png">

    <link rel="icon" href="/images/logo.png" type="image/x-icon">

    <!-- color to use by the browsers -->
    <meta name="theme-color" content="#98588C">

    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Roboto Mono' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Dosis:500' rel='stylesheet' type='text/css'>

    <!-- main page styles -->
    <link rel="stylesheet" href="/css/page.css">

    <!-- this needs to be loaded before guide's inline scripts -->
    <script>window.PAGE_TYPE = 'guide'</script>

    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NSK9WJ6');</script>
    <!-- End Google Tag Manager -->
  </head>
  <body class="docs">    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NSK9WJ6"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <div id="mobile-bar" >
      <a class="menu-button"></a>
      <a class="logo" href="/"></a>
    </div>

    <div id="header">
    <a id="logo" href="/">
        <img src="/images/logo.png">
        <span>Stellar</span>
    </a>
    <ul id="nav">
        <li>
  <form id="search-form">
    <input type="text" id="search-query-nav" class="search-query st-default-search-input">
  </form>
</li>
<li><a href="/guide/" class="nav-link current">Guide</a></li>
<li class="nav-dropdown-container">
  <a class="nav-link">Community</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/stellarFw/stellar" class="nav-link" target="_blank">GitHub</a></li>
    <li><a href="https://gitter.im/StellarFw/StellarFw" class="nav-link" target="_blank">Chat</a></li>
    <li><a href="https://twitter.com/gil0mendes" class="nav-link" target="_blank">Twitter</a></li>
  </ul>
</li>

<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/StellarFw/Identify" class="nav-link" target="_blank">Identify</a></li>
  </ul>
</li>


    </ul>
</div>

    
      <div id="main" class="fix-sidebar">
        
          
  <div class="sidebar">
  <ul class="main-menu">
    <li>
  <form id="search-form">
    <input type="text" id="search-query-sidebar" class="search-query st-default-search-input">
  </form>
</li>
<li><a href="/guide/" class="nav-link current">Guide</a></li>
<li class="nav-dropdown-container">
  <a class="nav-link">Community</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/stellarFw/stellar" class="nav-link" target="_blank">GitHub</a></li>
    <li><a href="https://gitter.im/StellarFw/StellarFw" class="nav-link" target="_blank">Chat</a></li>
    <li><a href="https://twitter.com/gil0mendes" class="nav-link" target="_blank">Twitter</a></li>
  </ul>
</li>

<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/StellarFw/Identify" class="nav-link" target="_blank">Identify</a></li>
  </ul>
</li>


  </ul>
  <div class="list">
    <div class="main-sponsor"></div>
    <a class="become-backer" href="/support-stellar">
      Become a Backer
    </a>

    <ul class="menu-root">
      
        
        
          
        

        <li>
          <a href="/guide/index.html" class="sidebar-link">Overview</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/installation.html" class="sidebar-link">Installation</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/actions.html" class="sidebar-link">Actions</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/tasks.html" class="sidebar-link">Tasks</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/middleware.html" class="sidebar-link">Middleware</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/satellites.html" class="sidebar-link">Satellites</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/cluster.html" class="sidebar-link">Cluster</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/cache.html" class="sidebar-link">Cache</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/chat.html" class="sidebar-link">Chat</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/development_mode.html" class="sidebar-link">Development Mode</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/file_system.html" class="sidebar-link">File System</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/events.html" class="sidebar-link">Events</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/websocket.html" class="sidebar-link">WebSocket</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/tcp.html" class="sidebar-link">TCP</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/http.html" class="sidebar-link">HTTP</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/security.html" class="sidebar-link">Security</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/validation.html" class="sidebar-link">Validation</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/logging.html" class="sidebar-link">Logging</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/commands.html" class="sidebar-link">Commands</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/testing.html" class="sidebar-link">Testing</a>
        </li>
      
        
        
          
            <li><h3>Models</h3></li>
          
        

        <li>
          <a href="/guide/models.html" class="sidebar-link">Introduction</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/models-data_types.html" class="sidebar-link">Data Types and Attributes</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/models-validations.html" class="sidebar-link">Validations</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/models-instance.html" class="sidebar-link">Instance and Class Methods</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/models-associations.html" class="sidebar-link">Associations</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/models-configurations.html" class="sidebar-link">Model Configuration</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/models-queries.html" class="sidebar-link current">Queries</a>
        </li>
      
    </ul>
  </div>
</div>



<div class="content guide with-sidebar models-queries-guide">
  
    <h1>Queries</h1>
  

  <p>The ORM Query Interface allows you to interact with your models the same way no matter which adapter they are using. This means you can use the same query language whether your data lives in MySQL, MongoDB, Redis, etc.</p>
<p>The Query Interface exposes the following methods:</p>
<ul>
<li><code>findOne</code></li>
<li><code>find</code></li>
<li><code>create</code></li>
<li><code>update</code></li>
<li><code>destroy</code></li>
<li><code>findOrCreate</code></li>
<li><code>count</code></li>
</ul>
<p>See <a href="#Query-Methods">Query Methods</a> for more information on their use.</p>
<h2 id="Simple-Querying"><a href="#Simple-Querying" class="headerlink" title="Simple Querying"></a>Simple Querying</h2><p>The ORM exposes a normalized language for finding records no matter which datastore the records live in. The following options are available on all <code>find</code> and <code>findOne</code> queries.</p>
<p>Each option will return an instance of the deferred object used to create the query, so options can be chained together to create complex queries.</p>
<p>See <a href="#Query-Language">Query Language</a> for more information on the options available in the query language.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">User.find()</span><br><span class="line">.where(&#123; <span class="attr">name</span>: &#123; <span class="attr">contains</span>: <span class="string">'foo'</span> &#125;&#125;)</span><br><span class="line">.populate(<span class="string">'animals'</span>, &#123; <span class="attr">type</span>: <span class="string">'dog'</span>, <span class="attr">limit</span>: <span class="number">10</span> &#125;)</span><br><span class="line">.skip(<span class="number">20</span>)</span><br><span class="line">.limit(<span class="number">10</span>)</span><br><span class="line">.exec(<span class="function">(<span class="params">err, users</span>) =&gt;</span> &#123; &#125;)</span><br></pre></td></tr></table></figure>
<p>For convenience, promises are supported if you choose to use them. Promises use the <a href="http://bluebirdjs.com" target="_blank" rel="noopener">Bluebird library</a>, so anything you do after the first <code>then</code> call (or <code>spread</code>, or <code>catch</code>), will be a complete Bluebird promise object. Remember, you must end the query somehow (by calling then or one of the other functions) in order to complete the database request.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">User.findOne()</span><br><span class="line">.where(&#123; <span class="attr">id</span>: <span class="number">2</span> &#125;)</span><br><span class="line">.then(<span class="function"><span class="params">user</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> comments = Comment.find(&#123; <span class="attr">userId</span>: user.id &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> [ user.id, user.friendsList, comments ]</span><br><span class="line">&#125;)</span><br><span class="line">.spread(<span class="function">(<span class="params">userId, friendsList, comments</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line">.catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// An error occured</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="where"><a href="#where" class="headerlink" title=".where()"></a>.where()</h3><p><code>where</code> is the primary criteria for your query. Here you specify what you would like to search for using any of the supported <a href="#Query-Language">Query Language</a>.</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Accepted Data Types</th>
<th>Required ?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Criteria Object</td>
<td><code>{}</code></td>
<td>Yes</td>
</tr>
</tbody>
</table>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">User.find()</span><br><span class="line">.where(&#123; <span class="attr">name</span>: &#123; <span class="attr">startsWith</span>: <span class="string">'w'</span> &#125;&#125;)</span><br><span class="line">.exec(<span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="populate"><a href="#populate" class="headerlink" title=".populate()"></a>.populate()</h3><p><code>populate</code> is used with associations to include any related values specified in a model definition. If a <code>collection</code> attribute is defined in a many-to-many, one-to-many or many-to-many-through association the <code>populate</code> option also accepts a full criteria object. This allows you to filter associations and run <code>limit</code> and <code>skip</code> on the results.</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Accepted Data Types</th>
<th>Required ?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Attribute Name</td>
<td><code>string</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Criteria Object</td>
<td><code>{}</code></td>
<td>No</td>
</tr>
</tbody>
</table>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Simple Population</span></span><br><span class="line">User.find()</span><br><span class="line">.populate(<span class="string">'foo'</span>)</span><br><span class="line">.exec(<span class="function">(<span class="params">err, users</span>) =&gt;</span> &#123; &#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Collection Filtering</span></span><br><span class="line">User.find()</span><br><span class="line">.populate(<span class="string">'foo'</span>, &#123; <span class="attr">type</span>: <span class="string">'bar'</span>, <span class="attr">limit</span>: <span class="number">20</span> &#125;)</span><br><span class="line">.exec(<span class="function">(<span class="params">err, users</span>) =&gt;</span> &#123; &#125;)</span><br></pre></td></tr></table></figure>
<h3 id="limit"><a href="#limit" class="headerlink" title=".limit()"></a>.limit()</h3><p><code>limit</code> will restrict the number of records returned by the query.</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Accepted Data Types</th>
<th>Required ?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Number to Return</td>
<td><code>int</code></td>
<td>Yes</td>
</tr>
</tbody>
</table>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">User.find()</span><br><span class="line">.limit(<span class="number">10</span>)</span><br><span class="line">.exec(<span class="function">(<span class="params">err, users</span>) =&gt;</span> &#123; &#125;)</span><br></pre></td></tr></table></figure>
<h3 id="skip"><a href="#skip" class="headerlink" title=".skip()"></a>.skip()</h3><p><code>skip</code> will skip over n results when returning the results.</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Accepted Data Types</th>
<th>Required ?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Number to Skip</td>
<td><code>int</code></td>
<td>Yes</td>
</tr>
</tbody>
</table>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">User.find()</span><br><span class="line">.skip(<span class="number">10</span>)</span><br><span class="line">.exec(<span class="function">(<span class="params">err, users</span>) =&gt;</span> &#123; &#125;)</span><br></pre></td></tr></table></figure>
<h3 id="paginate"><a href="#paginate" class="headerlink" title=".paginate()"></a>.paginate()</h3><p>When <code>skip</code> and <code>limit</code> are put together, they create the ability to paginate through records as you would for pages. For example, if I wanted ‘page 2’ of a given record set, and I only want to see 10 records at a time, I know that I need to <code>skip(10)</code> and <code>limit(10)</code> like so:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">User.find()</span><br><span class="line">.skip(<span class="number">10</span>)</span><br><span class="line">.limit(<span class="number">10</span>)</span><br><span class="line">.exec(<span class="function">(<span class="params">err, users</span>) =&gt;</span> &#123; &#125;)</span><br></pre></td></tr></table></figure>
<p>But, while we are thinking in terms of pagination, or pages, it might be easier to use the paginate helper:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">User.find()</span><br><span class="line">.paginate(&#123; <span class="attr">page</span>: <span class="number">2</span>, <span class="attr">limit</span>: <span class="number">10</span> &#125;)</span><br><span class="line">.exec(<span class="function">(<span class="params">err, users</span>) =&gt;</span> &#123; &#125;)</span><br></pre></td></tr></table></figure>
<p>Paginate has several options:</p>
<ul>
<li><code>paginate()</code> defaults options to <code>{ page: 0, limit: 10 }</code>.</li>
<li><code>paginate({page: 2})</code> uses <code>{ page: 2, limit: 10 }</code> as the options.</li>
<li><code>paginate({limit: 20})</code> uses <code>{ page: 0, limit: 20 }</code> as the options.</li>
<li><code>paginate({page: 1, limit: 20})</code> uses <code>{ page: 1, limit: 20 }</code> as the options.</li>
</ul>
<h3 id="sort"><a href="#sort" class="headerlink" title=".sort()"></a>.sort()</h3><p><code>sort</code> will return a sorted set of values. Simply specify an attribute name for natural (ascending) sort, or specify an <code>asc</code> or <code>desc</code> flag for ascending or descending orders respectively.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">User.find()</span><br><span class="line">.sort(<span class="string">'roleId asc'</span>)</span><br><span class="line">.sort(&#123; <span class="attr">createdAt</span>: <span class="string">'desc'</span> &#125;)</span><br><span class="line">.exec(<span class="function">(<span class="params">err, users</span>) =&gt;</span> &#123; &#125;)</span><br></pre></td></tr></table></figure>
<h3 id="exec"><a href="#exec" class="headerlink" title=".exec()"></a>.exec()</h3><p><code>exec</code> will run the query and return the results to the supplied callback. It should be the last method in the chain.</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Accepted Data Types</th>
<th>Required ?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Callback</td>
<td><code>function</code></td>
<td>Yes</td>
</tr>
</tbody>
</table>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">User.find()</span><br><span class="line">.exec(<span class="function">(<span class="params">err, users</span>) =&gt;</span> &#123; &#125;)</span><br></pre></td></tr></table></figure>
<h2 id="Query-Language"><a href="#Query-Language" class="headerlink" title="Query Language"></a>Query Language</h2><p>The criteria objects are formed using one of four types of object keys. These are the top level keys used in a query object. It is loosely based on the criteria used in MongoDB with a few slight variations.</p>
<p>Queries can be built using either a <code>where</code> key to specify attributes, which will allow you to also use query options such as <code>limit</code> and <code>skip</code> or if <code>where</code> is excluded the entire object will be treated as a <code>where</code> criteria.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123; <span class="attr">where</span>: &#123; <span class="attr">name</span>: <span class="string">'foo'</span> &#125;, <span class="attr">skip</span>: <span class="number">20</span>, <span class="attr">limit</span>: <span class="number">10</span>, <span class="attr">sort</span>: <span class="string">'name DESC'</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// OR</span></span><br><span class="line"></span><br><span class="line">Model.find(&#123; <span class="attr">name</span>: <span class="string">'foo'</span> &#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Key-Pairs"><a href="#Key-Pairs" class="headerlink" title="Key Pairs"></a>Key Pairs</h3><p>A key pair can be used to search records for values matching exactly what is specified. This is the base of a criteria object where the key represents an attribute on a model and the value is a strict equality check of the records for matching values.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123; <span class="attr">name</span>: <span class="string">'walter'</span> &#125;)</span><br></pre></td></tr></table></figure>
<p>They can be used together to search multiple attributes.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123; <span class="attr">name</span>: <span class="string">'walter'</span>, <span class="attr">state</span>: <span class="string">'new mexico'</span> &#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Modified-Pairs"><a href="#Modified-Pairs" class="headerlink" title="Modified Pairs"></a>Modified Pairs</h3><p>Modified pairs also have model attributes for keys but they also use any of the supported criteria modifiers to perform queries where a strict equality check wouldn’t work.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123;</span><br><span class="line">  name : &#123;</span><br><span class="line">    <span class="string">'contains'</span> : <span class="string">'alt'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>You can see more about this mater on a <a href="#Criteria-Modifiers">section above</a>.</p>
</blockquote>
<h3 id="In-Pairs"><a href="#In-Pairs" class="headerlink" title="In Pairs"></a>In Pairs</h3><p>IN queries work similarly to MySQL ‘in queries’. Each element in the array is treated as ‘or’.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123;</span><br><span class="line">  name : [<span class="string">'Walter'</span>, <span class="string">'Skyler'</span>]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Not-In-Pairs"><a href="#Not-In-Pairs" class="headerlink" title="Not-In Pairs"></a>Not-In Pairs</h3><p>Not-In queries work similar to <code>in</code> queries, except for the nested object criteria.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123;</span><br><span class="line">  name: &#123; <span class="string">'!'</span> : [<span class="string">'Walter'</span>, <span class="string">'Skyler'</span>] &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Or-Pairs"><a href="#Or-Pairs" class="headerlink" title="Or Pairs"></a>Or Pairs</h3><p>Performing <code>OR</code> queries is done by using an array of query pairs. Results will be returned that match any of the criteria objects inside the array.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123;</span><br><span class="line">  or : [</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">'walter'</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">occupation</span>: <span class="string">'teacher'</span> &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="Criteria-Modifiers"><a href="#Criteria-Modifiers" class="headerlink" title="Criteria Modifiers"></a>Criteria Modifiers</h2><p>The following modifiers are available to use when building queries.</p>
<ul>
<li><code>&#39;&lt;&#39;</code> / <code>&#39;lessThan&#39;</code></li>
<li><code>&#39;&lt;=&#39;</code> / <code>&#39;lessThanOrEqual&#39;</code></li>
<li><code>&#39;&gt;&#39;</code> / <code>&#39;greaterThan&#39;</code></li>
<li><code>&#39;&gt;=&#39;</code> / <code>&#39;greaterThanOrEqual&#39;</code></li>
<li><code>&#39;!&#39;</code> / <code>&#39;not&#39;</code></li>
<li><code>&#39;like&#39;</code></li>
<li><code>&#39;contains&#39;</code></li>
<li><code>&#39;startsWith&#39;</code></li>
<li><code>&#39;endsWith&#39;</code></li>
</ul>
<h3 id="‘-lt-’-‘lessThan’"><a href="#‘-lt-’-‘lessThan’" class="headerlink" title="‘&lt;’ / ‘lessThan’"></a>‘&lt;’ / ‘lessThan’</h3><p>Searches for records where the value is less than the value specified.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123; <span class="attr">age</span>: &#123; <span class="string">'&lt;'</span>: <span class="number">30</span> &#125;&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="‘-lt-’-‘lessThanOrEqual’"><a href="#‘-lt-’-‘lessThanOrEqual’" class="headerlink" title="‘&lt;=’ / ‘lessThanOrEqual’"></a>‘&lt;=’ / ‘lessThanOrEqual’</h3><p>Searches for records where the value is less or equal to the value specified.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123; <span class="attr">age</span>: &#123; <span class="string">'&lt;='</span>: <span class="number">21</span> &#125;&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="‘-gt-’-‘greaterThan’"><a href="#‘-gt-’-‘greaterThan’" class="headerlink" title="‘&gt;’ / ‘greaterThan’"></a>‘&gt;’ / ‘greaterThan’</h3><p>Searches for records where the value is more than the value specified.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123; <span class="attr">age</span>: &#123; <span class="string">'&gt;'</span>: <span class="number">18</span> &#125;&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="‘-gt-’-‘greaterThanOrEqual’"><a href="#‘-gt-’-‘greaterThanOrEqual’" class="headerlink" title="‘&gt;=’ / ‘greaterThanOrEqual’"></a>‘&gt;=’ / ‘greaterThanOrEqual’</h3><p>Searches for records where the value is more or equal to the value specified.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123; <span class="attr">age</span>: &#123; <span class="string">'&gt;='</span>: <span class="number">21</span> &#125;&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="‘-’-‘not’"><a href="#‘-’-‘not’" class="headerlink" title="‘!’ / ‘not’"></a>‘!’ / ‘not’</h3><p>Searches for records where the value is not equal to the value specified.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123; <span class="attr">name</span>: &#123; <span class="string">'!'</span>: <span class="string">'foo'</span> &#125;&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="‘like’"><a href="#‘like’" class="headerlink" title="‘like’"></a>‘like’</h3><p>Searches for records using pattern matching with the <code>%</code> sign.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123; <span class="attr">food</span>: &#123; <span class="string">'like'</span>: <span class="string">'%beans'</span> &#125;&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="‘contains’"><a href="#‘contains’" class="headerlink" title="‘contains’"></a>‘contains’</h3><p>A shorthand for pattern matching both sides of a string. Will return records where the value contains the string anywhere inside of it.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123; <span class="attr">class</span>: &#123; <span class="string">'contains'</span>: <span class="string">'history'</span> &#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// The same as</span></span><br><span class="line"></span><br><span class="line">Model.find(&#123; <span class="attr">class</span>: &#123; <span class="string">'like'</span>: <span class="string">'%history%'</span> &#125;&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="‘startsWith’"><a href="#‘startsWith’" class="headerlink" title="‘startsWith’"></a>‘startsWith’</h3><p>A shorthand for pattern matching the right side of a string. Will return records where the value<br>starts with the supplied string value.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123; <span class="attr">class</span>: &#123; <span class="string">'startsWith'</span>: <span class="string">'american'</span> &#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// The same as</span></span><br><span class="line"></span><br><span class="line">Model.find(&#123; <span class="attr">class</span>: &#123; <span class="string">'like'</span>: <span class="string">'american%'</span> &#125;&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="‘endsWith’"><a href="#‘endsWith’" class="headerlink" title="‘endsWith’"></a>‘endsWith’</h3><p>A shorthand for pattern matching the left side of a string. Will return records where the value<br>ends with the supplied string value.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123; <span class="attr">class</span>: &#123; <span class="string">'endsWith'</span>: <span class="string">'can'</span> &#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// The same as</span></span><br><span class="line"></span><br><span class="line">Model.find(&#123; <span class="attr">class</span>: &#123; <span class="string">'like'</span>: <span class="string">'%can'</span> &#125;&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="‘Date-Ranges’"><a href="#‘Date-Ranges’" class="headerlink" title="‘Date Ranges’"></a>‘Date Ranges’</h3><p>You can do date range queries using the comparison operators.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123; <span class="attr">date</span>: &#123; <span class="string">'&gt;'</span>: <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2/4/2014'</span>), <span class="string">'&lt;'</span>: <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2/7/2014'</span>) &#125; &#125;)</span><br></pre></td></tr></table></figure>
<h2 id="Query-Options"><a href="#Query-Options" class="headerlink" title="Query Options"></a>Query Options</h2><p>Query options allow you refine the results that are returned from a query. The current options available are:</p>
<ul>
<li><code>limit</code></li>
<li><code>skip</code></li>
<li><code>sort</code></li>
<li><code>select</code></li>
</ul>
<h3 id="Limit"><a href="#Limit" class="headerlink" title="Limit"></a>Limit</h3><p>Limits the number of results returned from a query.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123; <span class="attr">where</span>: &#123; <span class="attr">name</span>: <span class="string">'foo'</span> &#125;, <span class="attr">limit</span>: <span class="number">20</span> &#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Skip"><a href="#Skip" class="headerlink" title="Skip"></a>Skip</h3><p>Returns all the results excluding the number of items to skip.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123; <span class="attr">where</span>: &#123; <span class="attr">name</span>: <span class="string">'foo'</span> &#125;, <span class="attr">skip</span>: <span class="number">10</span> &#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Pagination"><a href="#Pagination" class="headerlink" title="Pagination"></a>Pagination</h3><p><code>skip</code> and <code>limit</code> can be used together to build up a pagination system.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Model.find(&#123; <span class="attr">where</span>: &#123; <span class="attr">name</span>: <span class="string">'foo'</span> &#125;, <span class="attr">limit</span>: <span class="number">10</span>, <span class="attr">skip</span>: <span class="number">10</span> &#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Sort"><a href="#Sort" class="headerlink" title="Sort"></a>Sort</h3><p>Results can be sorted by attribute name. Simply specify an attribute name for natural (ascending) sort, or specify an <code>asc</code> or <code>desc</code> flag for ascending or descending orders respectively.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Sort by name in ascending order</span></span><br><span class="line">Model.find(&#123; <span class="attr">where</span>: &#123; <span class="attr">name</span>: <span class="string">'foo'</span> &#125;, <span class="attr">sort</span>: <span class="string">'name'</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Sort by name in descending order</span></span><br><span class="line">Model.find(&#123; <span class="attr">where</span>: &#123; <span class="attr">name</span>: <span class="string">'foo'</span> &#125;, <span class="attr">sort</span>: <span class="string">'name DESC'</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Sort by name in ascending order</span></span><br><span class="line">Model.find(&#123; <span class="attr">where</span>: &#123; <span class="attr">name</span>: <span class="string">'foo'</span> &#125;, <span class="attr">sort</span>: <span class="string">'name ASC'</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Sort by binary notation</span></span><br><span class="line">Model.find(&#123; <span class="attr">where</span>: &#123; <span class="attr">name</span>: <span class="string">'foo'</span> &#125;, <span class="attr">sort</span>: &#123; <span class="string">'name'</span>: <span class="number">1</span> &#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Sort by multiple attributes</span></span><br><span class="line">Model.find(&#123; <span class="attr">where</span>: &#123; <span class="attr">name</span>: <span class="string">'foo'</span> &#125;, <span class="attr">sort</span>: &#123; <span class="attr">name</span>:  <span class="number">1</span>, <span class="attr">age</span>: <span class="number">0</span> &#125;&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="Query-Methods"><a href="#Query-Methods" class="headerlink" title="Query Methods"></a>Query Methods</h2><p>Every model will have a set of query methods exposed on it to allow you to interact with the database in a normalized fashion. These are known as the CRUD (Create-Read-Update-Delete) methods and is the primary way of interacting with your data.</p>
<p>There are also a special set of queries known as <em>dynamic queries</em>. These are special class methods that are dynamically generated. We call them dynamic finders. They perform many of the same functions as the other class methods but you can call them directly on an attribute in your model.</p>
<blockquote>
<p>For most class methods, the callback parameter is optional and if one is not supplied, it will return a chainable object.</p>
</blockquote>
<h3 id="CRUD-Methods"><a href="#CRUD-Methods" class="headerlink" title="CRUD Methods"></a>CRUD Methods</h3><h4 id="find-criteria-callback"><a href="#find-criteria-callback" class="headerlink" title=".find( criteria, [callback] )"></a>.find( <code>criteria</code>, [<code>callback</code>] )</h4><p><code>find</code> will return an array of records that match the supplied criteria. Criteria can be built using the <a href="#Query-Language">Query Language</a>.</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Accepted Data Types</th>
<th>Required ?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Find Criteria</td>
<td><code>{}</code>,<code>[{}]</code>, <code>string</code>, <code>int</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Callback</td>
<td><code>function</code></td>
<td>No</td>
</tr>
</tbody>
</table>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">User.find(&#123; <span class="attr">name</span>: <span class="string">'Walter Jr'</span> &#125;)</span><br><span class="line">.exec(<span class="function">(<span class="params">err, users</span>) =&gt;</span> &#123; &#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>NOTE: Any string arguments passed must be the ID of the record. This method will ALWAYS return records in an array. If you are trying to find an attribute that is an array, you must wrap it in an additional set of brackets otherwise the ORM will think you want to perform an inQuery.</p>
</blockquote>
<h4 id="findOne-criteria-callback"><a href="#findOne-criteria-callback" class="headerlink" title=".findOne( criteria, [callback] )"></a>.findOne( <code>criteria</code>, [<code>callback</code>] )</h4><p><code>findOne</code> will return an object with the first matching result in the datastore.</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Accepted Data Types</th>
<th>Required ?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Find Criteria</td>
<td><code>{}</code>,<code>[{}]</code>, <code>string</code>, <code>int</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Callback</td>
<td><code>function</code></td>
<td>No</td>
</tr>
</tbody>
</table>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">User.findOne(&#123; <span class="attr">name</span>: <span class="string">'Walter Jr'</span> &#125;)</span><br><span class="line">.exec(<span class="function">(<span class="params">err, user</span>) =&gt;</span> &#123; &#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>NOTE: Any string arguments passed must be the ID of the record. If you are trying to find an attribute that is an array, you must wrap it in an additional set of brackets otherwise Waterline will think you want to perform an inQuery.</p>
</blockquote>
<h4 id="create-criteria-callback"><a href="#create-criteria-callback" class="headerlink" title=".create( criteria, [callback] )"></a>.create( <code>criteria</code>, [<code>callback</code>] )</h4><p><code>create</code> will attempt to create a new record in the datastore. If the data is valid and passes all validations it will be sent to the adapters <code>create</code> method.</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Accepted Data Types</th>
<th>Required ?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Records to Create</td>
<td><code>{}</code>, <code>[{}]</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Callback</td>
<td><code>function</code></td>
<td>No</td>
</tr>
</tbody>
</table>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">User.create(&#123;</span><br><span class="line">  name: <span class="string">'Walter Jr'</span></span><br><span class="line">&#125;)</span><br><span class="line">.exec(<span class="function">(<span class="params">err, user</span>) =&gt;</span> &#123; &#125;)</span><br></pre></td></tr></table></figure>
<h4 id="findOrCreate-search-criteria-values-callback"><a href="#findOrCreate-search-criteria-values-callback" class="headerlink" title=".findOrCreate( search criteria, [values, callback] )"></a>.findOrCreate( <code>search criteria</code>, [<code>values</code>, <code>callback</code>] )</h4><p><code>findOrCreate</code> will return a single record if one was found or created, or an array of records if multiple get found/created via the supplied criteria or values. Criteria can be built using the <a href="Query-Language">Query Language</a>.</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Accepted Data Types</th>
<th>Required ?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Find Criteria</td>
<td><code>{}</code>,<code>[{}]</code>, <code>string</code>, <code>int</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Creation Values</td>
<td><code>{}</code>,<code>[{}]</code></td>
<td>No</td>
</tr>
<tr>
<td>Callback</td>
<td><code>function</code></td>
<td>No</td>
</tr>
</tbody>
</table>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">User.findOrCreate(&#123; <span class="attr">name</span>: <span class="string">'Walter Jr'</span> &#125;)</span><br><span class="line">.exec(<span class="function">(<span class="params">err, users</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="comment">//either user(s) with the name 'Walter Jr' get returned or</span></span><br><span class="line"><span class="comment">//a single user gets created with the name 'Walter Jr' and returned</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>NOTE: Any string arguments passed must be the ID of the record. This method can return a single record or an array of records. If a model is not found and creation values are omitted, it will get created with the supplied criteria values.</p>
</blockquote>
<blockquote>
<p>WARNING: Unless an adapter implements its own version of <code>findOrCreate</code>, <code>findOrCreate</code> will do the <code>find</code> and <code>create</code> calls in two separate steps (not transactional). In a high frequency scenario it’s possible for duplicates to be created if the query field(s) are not indexed.</p>
</blockquote>
<h4 id="update-search-criteria-values-callback"><a href="#update-search-criteria-values-callback" class="headerlink" title=".update( search criteria , values , [callback] )"></a>.update( <code>search criteria</code> , <code>values</code> , [<code>callback</code>] )</h4><p><code>update</code> will attempt to update any records matching the criteria passed in. Criteria can be built using the <a href="Query-Language">Query Language</a>.</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Accepted Data Types</th>
<th>Required ?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Find Criteria</td>
<td><code>{}</code>,<code>[{}]</code>, <code>string</code>, <code>int</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Updated Values</td>
<td><code>{}</code>,<code>[{}]</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Callback</td>
<td><code>function</code></td>
<td>No</td>
</tr>
</tbody>
</table>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">User.update(&#123; <span class="attr">name</span>: <span class="string">'Walter Jr'</span> &#125;, &#123; <span class="attr">name</span>: <span class="string">'Flynn'</span> &#125;)</span><br><span class="line">.exec(<span class="function">(<span class="params">err, users</span>) =&gt;</span> &#123; &#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>NOTE: Although you may pass <code>.update()</code> an object or an array of objects, it will always return an array of objects. Any string arguments passed must be the ID of the record. If you specify a primary key (e.g. <code>7</code> or <code>50c9b254b07e040200000028</code>) instead of a criteria object, any <code>.where()</code> filters will be ignored.</p>
</blockquote>
<h4 id="destroy-criteria-callback"><a href="#destroy-criteria-callback" class="headerlink" title=".destroy( criteria , [callback] )"></a>.destroy( <code>criteria</code> , [<code>callback</code>] )</h4><p><code>destroy</code> will destroy any records matching the provided criteria. Criteria can be built using the <a href="Query-Language">Query Language</a>.</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Accepted Data Types</th>
<th>Required ?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Find Criteria</td>
<td><code>{}</code>,<code>[{}]</code>, <code>string</code>, <code>int</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Callback</td>
<td><code>function</code></td>
<td>No</td>
</tr>
</tbody>
</table>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">User.destroy(&#123; <span class="attr">name</span>: <span class="string">'Flynn'</span> &#125;)</span><br><span class="line">.exec(<span class="function"><span class="params">err</span> =&gt;</span> &#123; &#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>NOTE: If you want to confirm the record exists before you delete it, you must first perform a find(). Any string arguments passed must be the ID of the record.</p>
</blockquote>
<h4 id="query-query-data-callback"><a href="#query-query-data-callback" class="headerlink" title=".query( query, [data], callback )"></a>.query( <code>query</code>, <code>[data]</code>, <code>callback</code> )</h4><p>Some adapters, such as <a href="https://github.com/balderdashy/sails-mysql" target="_blank" rel="noopener">sails-mysql</a> and <a href="https://github.com/balderdashy/sails-postgresql" target="_blank" rel="noopener">sails-postgresql</a>, support the <code>query</code> function which will run the provided RAW query against the database. This can sometimes be useful if you want to run complex queries and performance is very important.</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Accepted Data Types</th>
<th>Required ?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Query</td>
<td><code>string</code></td>
<td>Yes</td>
</tr>
<tr>
<td>Data</td>
<td><code>array</code></td>
<td>No</td>
</tr>
<tr>
<td>Callback</td>
<td><code>function</code></td>
<td>Yes</td>
</tr>
</tbody>
</table>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> title = <span class="string">"The King's Speech"</span>;</span><br><span class="line"></span><br><span class="line">Movie.query(<span class="string">'SELECT * FROM movie WHERE title = $1'</span>, [title], (err, results) =&gt; &#123;</span><br><span class="line">  <span class="comment">// using sails-postgresql</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Found the following movie: '</span>, results.rows[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">  <span class="comment">// using sails-mysql</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Found the following movie: '</span>, results[<span class="number">0</span>])</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>NOTE: The type of the results returned depend on your adapter: sails-mysql returns an array of objects and sails-postgresql returns an object containing metadata and the actual results within a ‘rows’ array. This function does currently not support promises.</p>
</blockquote>
<h3 id="Aggregates"><a href="#Aggregates" class="headerlink" title="Aggregates"></a>Aggregates</h3><p>Some adapters (including <a href="https://github.com/balderdashy/sails-mysql" target="_blank" rel="noopener">sails-mysql</a> and <a href="https://github.com/balderdashy/sails-postgresql" target="_blank" rel="noopener">sails-postgresql</a>) support aggregate queries using specific grouping and aggregation methods. Currently <code>groupBy</code> for grouping and <code>max</code>, <code>min</code>, <code>sum</code>, and <code>average</code> for aggregation are supported. For SQL based adapters if <code>groupBy</code> is used then at least one aggregate must be specified as well, and only the aggregated and grouped attributes will be returned in the results.</p>
<h4 id="groupBy-attribute-or-expression"><a href="#groupBy-attribute-or-expression" class="headerlink" title=".groupBy( attribute or expression )"></a>.groupBy( <code>attribute</code> or <code>expression</code> )</h4><p><code>groupBy</code> will group results by the specified attribute or expression (for SQL adapters that support expressions).</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Accepted Data Types</th>
<th>Required ?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Attribute or Expression</td>
<td><code>string</code></td>
<td>Yes</td>
</tr>
</tbody>
</table>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Find the highest grossing movie by genre.</span></span><br><span class="line">Movie.find()</span><br><span class="line">	.groupBy(<span class="string">'genre'</span>)</span><br><span class="line">	.max(<span class="string">'revenue'</span>)</span><br><span class="line">	.then(<span class="function"><span class="params">results</span> =&gt;</span> &#123;</span><br><span class="line">		<span class="comment">// Max revenue for the first genre.</span></span><br><span class="line">		results[<span class="number">0</span>].revenue</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Find the highest grossing movie by year.</span></span><br><span class="line">Movie.find()</span><br><span class="line">	.groupBy(<span class="string">'to_char("movie"."releaseDate", \'YYYY\')'</span>)</span><br><span class="line">	.max(<span class="string">'revenue'</span>)</span><br><span class="line">	.then(<span class="function"><span class="params">results</span> =&gt;</span> &#123;</span><br><span class="line">		<span class="comment">// Max revenue for the first year.</span></span><br><span class="line">		results[<span class="number">0</span>].revenue;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// The first year.</span></span><br><span class="line">		results[<span class="number">0</span>].group0</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>NOTE: As specified by the <a href="https://github.com/balderdashy/waterline-adapter-tests/tree/master/interfaces/sql" target="_blank" rel="noopener">Waterline SQL Interface</a>, along with attributes SQL expressions are accepted by the <code>groupBy</code> method. This allows you to create queries that group by month or year on a datetime field. Since expressions don’t provide an attribute to serve as a key in the returned results the <code>groupBy</code> method will key each grouped attribute with <code>group0</code> where <code>0</code> is the index of the <code>groupBy</code> method call containing the expression.</p>
</blockquote>
<h4 id="max-attribute"><a href="#max-attribute" class="headerlink" title=".max( attribute )"></a>.max( <code>attribute</code> )</h4><p><code>max</code> will find the maximum value for the given attribute.</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Accepted Data Types</th>
<th>Required ?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Attribute</td>
<td><code>string</code></td>
<td>Yes</td>
</tr>
</tbody>
</table>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Find the highest grossing movie by genre.</span></span><br><span class="line">Movie.find()</span><br><span class="line">	.groupBy(<span class="string">'genre'</span>)</span><br><span class="line">	.max(<span class="string">'revenue'</span>)</span><br><span class="line">	.then(<span class="function"><span class="params">results</span> =&gt;</span> &#123;</span><br><span class="line">		<span class="comment">// Max revenue for the first genre.</span></span><br><span class="line">		results[<span class="number">0</span>].revenue</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="min-attribute"><a href="#min-attribute" class="headerlink" title=".min( attribute )"></a>.min( <code>attribute</code> )</h4><p><code>min</code> will find the minimum value for the given attribute.</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Accepted Data Types</th>
<th>Required ?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Attribute</td>
<td><code>string</code></td>
<td>Yes</td>
</tr>
</tbody>
</table>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Find the lowest grossing movie by genre.</span></span><br><span class="line">Movie.find()</span><br><span class="line">	.groupBy(<span class="string">'genre'</span>)</span><br><span class="line">	.min(<span class="string">'revenue'</span>)</span><br><span class="line">	.then(<span class="function"><span class="params">results</span> =&gt;</span> &#123;</span><br><span class="line">		<span class="comment">// Min revenue for the first genre.</span></span><br><span class="line">		results[<span class="number">0</span>].revenue</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="sum-attribute"><a href="#sum-attribute" class="headerlink" title=".sum( attribute )"></a>.sum( <code>attribute</code> )</h4><p><code>sum</code> will find the summed total for the given attribute.</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Accepted Data Types</th>
<th>Required ?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Attribute</td>
<td><code>string</code></td>
<td>Yes</td>
</tr>
</tbody>
</table>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Find the movie revenue by genre.</span></span><br><span class="line">Movie.find()</span><br><span class="line">	.groupBy(<span class="string">'genre'</span>)</span><br><span class="line">	.sum(<span class="string">'revenue'</span>)</span><br><span class="line">	.then(<span class="function"><span class="params">results</span> =&gt;</span> &#123;</span><br><span class="line">		<span class="comment">// Total revenue for the first genre.</span></span><br><span class="line">		results[<span class="number">0</span>].revenue</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="average-attribute"><a href="#average-attribute" class="headerlink" title=".average( attribute )"></a>.average( <code>attribute</code> )</h4><p><code>average</code> will find the average value for the given attribute.</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Accepted Data Types</th>
<th>Required ?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Attribute</td>
<td><code>string</code></td>
<td>Yes</td>
</tr>
</tbody>
</table>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Find the average movie revenue by genre.</span></span><br><span class="line">Movie.find()</span><br><span class="line">	.groupBy(<span class="string">'genre'</span>)</span><br><span class="line">	.average(<span class="string">'revenue'</span>)</span><br><span class="line">	.then(<span class="function"><span class="params">results</span> =&gt;</span> &#123;</span><br><span class="line">		<span class="comment">// Average revenue for the first genre.</span></span><br><span class="line">		results[<span class="number">0</span>].revenue;</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>


  
      <div class="guide-links">
        
          <span>← <a href="/guide/models-configurations.html">Model Configuration</a></span>
        
        
      </div>
    

    <div class="footer">
      Caught a mistake or want to contribute to documentation?
      <a href="https://github.com/StellarFw/stellar-framework.com/tree/master/src/guide/models-queries.md" target="_blank">
        Edit this page on Github!
      </a>
    </div>
</div>

        
      </div>
      <script src="/js/smooth-scroll.min.js"></script>
    

    <!-- search -->
    <link href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="/css/search.css">
    <script src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js" type="text/javascript"></script>

    <!-- main custom script for sidebar and other cool things -->
    <script src="/js/common.js"></script>

    <!-- fastclick  -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        FastClick.attach(document.body)
      }, false)
    </script>
  </body>
</html>
