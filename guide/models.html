
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Introduction - Stellar</title>
    <meta charset="utf-8">
    <meta name="description" content="Stellar is an action based web framework for creating Web APIs easily!">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Introduction - Stellar">
    <meta property="og:description" content="Stellar is an action based web framework for creating Web APIs easily!">
    <meta property="og:image" content="https://stellar-framework.com/images/logo.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Introduction - Stellar">
    <meta name="twitter:description" content="Stellar is an action based web framework for creating Web APIs easily!">
    <meta name="twitter:image" content="https://stellar-framework.com/images/logo.png">

    <link rel="icon" href="/images/logo.png" type="image/x-icon">

    <!-- color to use by the browsers -->
    <meta name="theme-color" content="#98588C">

    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Roboto Mono' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Dosis:500' rel='stylesheet' type='text/css'>

    <!-- main page styles -->
    <link rel="stylesheet" href="/css/page.css">

    <!-- this needs to be loaded before guide's inline scripts -->
    <script>window.PAGE_TYPE = 'guide'</script>

    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NSK9WJ6');</script>
    <!-- End Google Tag Manager -->
  </head>
  <body class="docs">    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NSK9WJ6"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <div id="mobile-bar" >
      <a class="menu-button"></a>
      <a class="logo" href="/"></a>
    </div>

    <div id="header">
    <a id="logo" href="/">
        <img src="/images/logo.png">
        <span>Stellar</span>
    </a>
    <ul id="nav">
        <li>
  <form id="search-form">
    <input type="text" id="search-query-nav" class="search-query st-default-search-input">
  </form>
</li>
<li><a href="/guide/" class="nav-link current">Guide</a></li>
<li class="nav-dropdown-container">
  <a class="nav-link">Community</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/stellarFw/stellar" class="nav-link" target="_blank">GitHub</a></li>
    <li><a href="https://gitter.im/StellarFw/StellarFw" class="nav-link" target="_blank">Chat</a></li>
    <li><a href="https://twitter.com/gil0mendes" class="nav-link" target="_blank">Twitter</a></li>
  </ul>
</li>

<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/StellarFw/Identify" class="nav-link" target="_blank">Identify</a></li>
  </ul>
</li>


    </ul>
</div>

    
      <div id="main" class="fix-sidebar">
        
          
  <div class="sidebar">
  <ul class="main-menu">
    <li>
  <form id="search-form">
    <input type="text" id="search-query-sidebar" class="search-query st-default-search-input">
  </form>
</li>
<li><a href="/guide/" class="nav-link current">Guide</a></li>
<li class="nav-dropdown-container">
  <a class="nav-link">Community</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/stellarFw/stellar" class="nav-link" target="_blank">GitHub</a></li>
    <li><a href="https://gitter.im/StellarFw/StellarFw" class="nav-link" target="_blank">Chat</a></li>
    <li><a href="https://twitter.com/gil0mendes" class="nav-link" target="_blank">Twitter</a></li>
  </ul>
</li>

<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><a href="https://github.com/StellarFw/Identify" class="nav-link" target="_blank">Identify</a></li>
  </ul>
</li>


  </ul>
  <div class="list">
    <div class="main-sponsor"></div>
    <a class="become-backer" href="/support-stellar">
      Become a Backer
    </a>

    <ul class="menu-root">
      
        
        
          
        

        <li>
          <a href="/guide/index.html" class="sidebar-link">Overview</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/installation.html" class="sidebar-link">Installation</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/actions.html" class="sidebar-link">Actions</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/tasks.html" class="sidebar-link">Tasks</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/middleware.html" class="sidebar-link">Middleware</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/satellites.html" class="sidebar-link">Satellites</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/cluster.html" class="sidebar-link">Cluster</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/cache.html" class="sidebar-link">Cache</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/chat.html" class="sidebar-link">Chat</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/development_mode.html" class="sidebar-link">Development Mode</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/file_system.html" class="sidebar-link">File System</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/events.html" class="sidebar-link">Events</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/websocket.html" class="sidebar-link">WebSocket</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/tcp.html" class="sidebar-link">TCP</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/http.html" class="sidebar-link">HTTP</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/security.html" class="sidebar-link">Security</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/validation.html" class="sidebar-link">Validation</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/logging.html" class="sidebar-link">Logging</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/commands.html" class="sidebar-link">Commands</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/testing.html" class="sidebar-link">Testing</a>
        </li>
      
        
        
          
            <li><h3>Models</h3></li>
          
        

        <li>
          <a href="/guide/models.html" class="sidebar-link current">Introduction</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/models-data_types.html" class="sidebar-link">Data Types and Attributes</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/models-validations.html" class="sidebar-link">Validations</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/models-instance.html" class="sidebar-link">Instance and Class Methods</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/models-associations.html" class="sidebar-link">Associations</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/models-configurations.html" class="sidebar-link">Model Configuration</a>
        </li>
      
        
        
          
        

        <li>
          <a href="/guide/models-queries.html" class="sidebar-link">Queries</a>
        </li>
      
    </ul>
  </div>
</div>



<div class="content guide with-sidebar models-guide">
  
    <h1>Introduction</h1>
  

  <p>The model system included with Stellar provides a straight-forward, schema-based solution to model your application data. It includes built-in type casting, validation, query building, business logic hooks and more, out of the box. All to work with you database. This set of features that we provide are only possible because we chose <a href="https://github.com/balderdashy/waterline" target="_blank" rel="noopener">Waterline</a> to be our primary ORM.</p>
<p>Each database collection has a corresponding “Model” which is used to interact with that collection. Models allow you to query for data in your collections, as well as insert new records into the collection.</p>
<p>Before getting started, be sure to configure a database connection in <code>config/database.js</code>. For more information on configuring your database, check out the documentation.</p>
<h2 id="First-steps"><a href="#First-steps" class="headerlink" title="First steps"></a>First steps</h2><h3 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h3><p>The database configuration for your application is located at <code>config/database.js</code>, but you can choose some other name, we use this to better know what configs are inside the file. If you do not configure it an in-memory database will be used, this is done to provide you a out of the box way to start developing your API without hurry about configurations and is a great way to mock or database on a testing environment.</p>
<p>So, just for example we will create a connection with a MongoDB database.</p>
<p>First of all we need to add the database adapter as an dependency, for that you use the <code>npmDependencies</code> property on the <code>manifest.json</code> file of your package.</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"id"</span>: <span class="string">"private"</span>,</span><br><span class="line">    <span class="attr">"name"</span>: <span class="string">"Private Module"</span>,</span><br><span class="line">    <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">    <span class="attr">"description"</span>: <span class="string">"This module exists to store the private project actions and tasks"</span>,</span><br><span class="line">    <span class="attr">"npmDependencies"</span>: &#123;</span><br><span class="line">      <span class="attr">"sails-mongo"</span>: <span class="string">"0.12.2"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The next step is configure the connection on the <code>config/database.js</code>, or otehr filename that you want:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">exports.production = &#123;</span><br><span class="line">  models: <span class="function"><span class="params">api</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      adapters: &#123;</span><br><span class="line">        <span class="string">'mongodb'</span>: <span class="string">'sails-mongo'</span></span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line">      connections: &#123;</span><br><span class="line">        mongodb: &#123;</span><br><span class="line">          adapter: <span class="string">'mongodb'</span>,</span><br><span class="line">          url: <span class="string">'mongodb://jarvis:somepassword@example.com:27017/awesomeDb'</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line">      defaults: &#123;</span><br><span class="line">        migrate: <span class="string">'safe'</span></span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line">      defaulConnection: <span class="string">'mongodb'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>So, let’s stop for a while an check what we have done here. First of all, we specify a new adapter using the package name that we add before on the dependencies, we call our adapter of “mongodb”, but you can give it some other name. Then we create a new connection using the standard connection string, which is already known for the mongo users.</p>
<blockquote>
<p>NOTE: on the connection, with the exception of the <code>adapter</code>, the other key-value pairs are all configs related with the chosen adapter. You can see the adapter documentation to see what you need put here.</p>
</blockquote>
<p>Finally, we set the new connection as the default one, and done! No we are ready to go.</p>
<p>Note that you need to install the adapter before run, for that you can start the server using the <code>--update</code> options like this:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">stellar run --update</span><br></pre></td></tr></table></figure>
<h3 id="Defining-Models"><a href="#Defining-Models" class="headerlink" title="Defining Models"></a>Defining Models</h3><p>To get started, let’s create an model. Models live in the <code>models</code> directory on the modules roots.</p>
<p>The easiest way to create a model instance is using the <code>makeModel</code> command:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">stellar makeModel User --module=authentication</span><br></pre></td></tr></table></figure>
<p>If you would like to generate a CRUD action when you generate the model, you may use the <code>--crud</code> option:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">stellar makeModel User --module=authentication --crud</span><br></pre></td></tr></table></figure>
<blockquote>
<p>NOTE: the generated code uses the function syntax. You can see more about that on the next subsection.</p>
</blockquote>
<p>All the models are loaded into memory when a new Stellar instance is started, so you have a global place where all the models lives (<code>api.models</code>). Ahead will be able to see how to get a model an use it on your code.</p>
<h3 id="Model-Conventions"><a href="#Model-Conventions" class="headerlink" title="Model Conventions"></a>Model Conventions</h3><p>Now, let’s look at an example <code>Content</code> model, which we will use to retrieve and store information from our <code>contents</code> database collection:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"></span><br><span class="line">exports.default = &#123;</span><br><span class="line">  title: <span class="string">'string'</span>,</span><br><span class="line">  content: <span class="string">'string'</span>,</span><br><span class="line">  source: <span class="string">'string'</span>,</span><br><span class="line">  tags: <span class="string">'array'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Note that you can use a function instead of an <code>Object</code>, to define more advanced models.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">exports.default = <span class="function"><span class="params">api</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// create a new model</span></span><br><span class="line">  <span class="keyword">const</span> newModel = &#123;</span><br><span class="line">    attributes: &#123;</span><br><span class="line">      <span class="comment">// <span class="doctag">TODO:</span> add fields to this model</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> newModel</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Extend-Models"><a href="#Extend-Models" class="headerlink" title="Extend Models"></a>Extend Models</h2><p>For now, there is no way to replace or modify already created models. So, in order to manipulate (add, modify or remove) fields, Stellar provides a custom event on the model insertion. The event name is <code>core.models.add.{name}</code>, <code>name</code> is dynamic and is replaced with the model name. Using this naming convention we don’t need to call all the listeners who modify models, instead of that we just call the right listeners for that specific model.</p>
<p>The <code>core.models.add.{name}</code> event receives an instance of the Model (<code>model</code>) as you can see bellow. The follow example shows how to extend a model. In this case we are adding two new fields to the <code>user</code> model:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">exports.editUserModel = &#123;</span><br><span class="line">  event: <span class="string">'core.models.add.user'</span>,</span><br><span class="line">  description: <span class="string">'This adds the address and the phone fields to the user model'</span>,</span><br><span class="line"></span><br><span class="line">  run (api, params, next) &#123;</span><br><span class="line">    <span class="comment">// get the user model</span></span><br><span class="line">    <span class="keyword">const</span> User = params.model</span><br><span class="line"></span><br><span class="line">    <span class="comment">// add the new two fields</span></span><br><span class="line">    User.attributes = <span class="built_in">Object</span>.assign(User.attributes, &#123;</span><br><span class="line">      address: &#123; <span class="attr">type</span>: <span class="string">'string'</span>, <span class="attr">defaultsTo</span>: <span class="literal">null</span> &#125;,</span><br><span class="line">      phone: &#123; <span class="attr">type</span>: <span class="string">'string'</span>, <span class="attr">defaultsTo</span>: <span class="literal">null</span> &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// finish the event execution</span></span><br><span class="line">    next()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Note that the <code>user</code> model is owned by another module (for example, the <a href="https://github.com/stellarFw/Identify" target="_blank" rel="noopener">Authentication module</a>).</p>
</blockquote>


  
      <div class="guide-links">
        
          <span>← <a href="/guide/testing.html">Testing</a></span>
        
        
          <span style="float:right"><a href="/guide/models-data_types.html">Data Types and Attributes</a> →</span>
        
      </div>
    

    <div class="footer">
      Caught a mistake or want to contribute to documentation?
      <a href="https://github.com/StellarFw/stellar-framework.com/tree/master/src/guide/models.md" target="_blank">
        Edit this page on Github!
      </a>
    </div>
</div>

        
      </div>
      <script src="/js/smooth-scroll.min.js"></script>
    

    <!-- search -->
    <link href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="/css/search.css">
    <script src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js" type="text/javascript"></script>

    <!-- main custom script for sidebar and other cool things -->
    <script src="/js/common.js"></script>

    <!-- fastclick  -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        FastClick.attach(document.body)
      }, false)
    </script>
  </body>
</html>
